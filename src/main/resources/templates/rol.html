<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head>
        <title>Informacion</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link th:replace="/fragments/Boostrap-Icono :: link"></link>
        
        <!-- Tus estilos personalizados u hojas de estilo adicionales -->
        <link href="/perfil_usuario.css" rel="stylesheet" type="text/css"/>

    </head>

    <body>
        <!-- Fragments del Navbar -->
        <nav th:replace="/fragments/navbarLogueado :: nav"></nav>
        <br><br>
        
        <h1 align="center" class="Sunday">Cambiar de Rol</h1>

        <br><br>


    <body>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-4">
                    <form th:action="@{/modificarRol/{id}(id=${usuario.id})}" method="POST">
                        <input type="hidden" name="id" th:value="${usuario.id}">

                        <div  align="center" class="form-group">
                            <label for="nuevoRol"><h3>Seleccionar nuevo Rol</h3></label>
                            <select id="nuevoRol" name="nuevoRol" class="form-control" required onchange="mostrarCamposProveedor()">
                                <option value="USER">Usuario</option>
                                <option value="PROVEEDOR">Proveedor</option>
                            </select>
                        </div>

                        <div class="form-group my-2" id="nombreEmpresaDiv" style="display: none;">
                            <input type="text" class="form-control" name="nombreEmpresa" placeholder="NOMBRE DE EMPRESA" th:value="${nombreEmpresa}">
                        </div>

                        <div id="tipoServicioDiv" style="display: none;">
                            <select class="form-control" name="tipoServicio" id="tipoServicio" th:value="${tipoServicio}">
                                <option value="">Selecciona el Tipo de Servicio de tu Empresa</option>
                                <option value="Gasista">Gasista</option>
                                <option value="Electricista">Electricista</option>
                                <option value="Plomero">Plomero</option>
                            </select>
                        </div>
                        <br><br>
                        <div class="d-flex justify-content-center">
                            <button type="submit" class="btn btn-dark">Modificar</button>
                        </div>
                    </form>
                </div>
            </div>

            <script>
                function mostrarCamposProveedor() {
                var rolSelect = document.getElementById("nuevoRol");
                var nombreEmpresaDiv = document.getElementById("nombreEmpresaDiv");
                var tipoServicioDiv = document.getElementById("tipoServicioDiv");

                if (rolSelect.value === "PROVEEDOR") {
                nombreEmpresaDiv.style.display = "block";
                tipoServicioDiv.style.display = "block";
                } else {
                nombreEmpresaDiv.style.display = "none";
                tipoServicioDiv.style.display = "none";
                }
                }
            </script>
            <br>
            <br>

            <div th:if="${error}" class="alert alert-danger text-center">
                <p th:text="${error}" class="text-large">Mensaje de error personalizado</p>
            </div>

            <!-- Alerta de Éxito -->
            <div th:if="${mensaje}" class="alert alert-success text-center">
                <p th:text="${mensaje}" class="text-large">Mensaje de éxito personalizado</p>
            </div>
        </div>

        <br><br><br><br><br><br>
        
        

        <!-- Fragments del Footer -->
        <div th:replace="/fragments/footer :: div"></div>

        <!-- Bootstrap y otras dependencias -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    </body>

</html>